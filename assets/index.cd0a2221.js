import{D as e,r as t,R as a,L as n,i as r,B as s,a as c,b as l}from"./vendor.1dfe7a34.js";const o=e=>`\n            <!DOCTYPE HTML>\n            <html>\n                <head>\n                    <script src="https://cdn.jsdelivr.net/npm/p5@1.3.1/lib/p5.js"><\/script>\n                    <script src="https://cdn.jsdelivr.net/npm/p5.recorder@0.0.7/dist/p5.recorder.js"><\/script>\n                    <script id="script-base">${e}<\/script>\n                    <script>\n                        var rec = new p5.Recorder(false)\n                        var toggle = false\n                    <\/script>\n                </head>\n                <body>\n                    <main></main>\n                </body>\n            </html>\n    `;let i=new e("generative-db");i.version(1).stores({sketches:"++id,name,source"});const m=t.exports.createContext(i);function d(e){return t.exports.useState(e.sketchTitle),a.createElement("div",{className:"header-bar"},a.createElement(n,{to:"/"},a.createElement("h1",{className:"hb-text"},"p5 ide")),a.createElement("h3",null,e.sketchTitle),e.isEditor&&a.createElement("div",null,a.createElement("button",{className:"button-action",onClick:e.reloadHandler},"Reload"),a.createElement("button",{className:"button-action",onClick:e.exportHandler},"Export")))}function u(e){const n=t.exports.useRef(null),[s,c]=t.exports.useState(""),[l,u]=t.exports.useState(""),p=t.exports.useContext(m),h=t.exports.useRef(null);console.log(e.match.params.id);const E=parseInt(e.match.params.id);return t.exports.useEffect((()=>(p.sketches.get(E).then((e=>{c(e.source)})),()=>{})),[]),a.createElement(a.Fragment,null,a.createElement(d,{sketchTitle:l,exportHandler:()=>{console.log("fhfhahsh");let e=new Blob([s],{type:"text/plain"}),t=document.createElement("a");document.body.appendChild(t),t.download=l+".js",t.href=URL.createObjectURL(e),t.click()},titleHandler:e=>{u(e.target.value)},reloadHandler:()=>{h.current.contentWindow.location.reload()},update:e=>{i.sketches.update(E,{name:e}).then((function(e){e&&console.log("Name updated.")}))},isEditor:!0}),a.createElement("div",{className:"app-container"},a.createElement(r,{height:"90vh",width:"50vw",theme:"vs-dark",options:{minimap:!1},defaultLanguage:"javascript",value:s,className:"editor",onMount:(e,t)=>{n.current=e,p.sketches.get(E).then((t=>{c(t.source),u(t.name),e.value=t.source}))},onChange:(e,t)=>{c(e),i.sketches.update(E,{source:e}).then((function(e){e&&console.log("Source updated.")}))}}),a.createElement("div",{className:"frame-section"},a.createElement("iframe",{ref:h,className:"pframe",frameBorder:"0",marginWidth:"0",marginHeight:"0",srcDoc:o(s)}))))}function p(){const[e,r]=t.exports.useState([]),[l,o]=t.exports.useState(!1),[p,h]=t.exports.useState(""),E=()=>{i.sketches.toArray().then((e=>r(e)))};return t.exports.useEffect((()=>(E(),()=>{})),[]),a.createElement(s,null,a.createElement(c,{exact:!0,path:"/"},a.createElement(d,{sketchTitle:"",isEditor:!1}),l&&a.createElement("div",{className:"overlay-modal"},a.createElement("div",{className:"name-prompt"},a.createElement("h2",null,"Name your sketch."),a.createElement("input",{type:"text",onChange:e=>h(e.target.value),value:p}),a.createElement("button",{className:"button-action",onClick:()=>{i.sketches.put({name:p,source:""}),o(!1),h(""),E()}},"Create"))),a.createElement("div",{className:"gallery-container"},a.createElement("div",{className:"gallery-entry",onClick:()=>{o(!0)}},a.createElement("h1",{className:"plus-icon"},"+")),e.map((e=>a.createElement(n,{to:"/editor/"+e.id,key:e.id},a.createElement("div",{className:"gallery-entry"},a.createElement("h3",null,e.name))))))),a.createElement(m.Provider,{value:i},a.createElement(c,{path:"/editor/:id",component:u})))}l.render(a.createElement(a.StrictMode,null,a.createElement(p,null)),document.getElementById("root"));
